# 备份到 GitHub 和部署到云服务器 - 操作步骤

## 第一步：备份到 GitHub

### 在终端中执行以下命令：

```bash
# 1. 进入项目目录
cd "/Users/hailian-test/Desktop/cursor 1.0/建站_260120 0.3"

# 2. 初始化 Git 仓库
git init

# 3. 添加所有文件
git add .

# 4. 创建初始提交
git commit -m "初始提交: 舜泰汽车官网 - 已完成国内环境适配"

# 5. 在 GitHub 上创建新仓库后，添加远程仓库（替换 YOUR_USERNAME 和 YOUR_REPO_NAME）
git remote add origin https://github.com/YOUR_USERNAME/YOUR_REPO_NAME.git

# 6. 重命名分支为 main
git branch -M main

# 7. 推送到 GitHub
git push -u origin main
```

### GitHub 创建仓库步骤：

1. 访问 https://github.com
2. 点击右上角 "+" → "New repository"
3. 填写信息：
   - Repository name: `shuntai-website`（或其他名称）
   - Description: `舜泰汽车官方网站`
   - 选择 Public 或 Private
   - **不要**勾选 "Initialize this repository with a README"
4. 点击 "Create repository"
5. 复制仓库地址，替换上面的命令中的 URL

## 第二步：构建生产版本

```bash
# 确保在项目目录
cd "/Users/hailian-test/Desktop/cursor 1.0/建站_260120 0.3"

# 安装依赖（如果还没安装）
npm install

# 构建生产版本
npm run build
```

构建完成后，会在项目目录下生成 `dist/` 文件夹，包含所有需要部署的文件。

## 第三步：部署到阿里云服务器

### 方案1：使用 Nginx 部署（推荐）

#### 1. 上传文件到服务器

**方式A：使用 SCP 命令**

```bash
# 将 dist 目录内容上传到服务器
scp -r dist/* root@your-server-ip:/var/www/html/
```

**方式B：使用 rsync（推荐，支持增量更新）**

```bash
rsync -avz --delete dist/ root@your-server-ip:/var/www/html/
```

**方式C：使用 SFTP 客户端**

- 使用 FileZilla、WinSCP 等工具
- 连接服务器后，将 `dist/` 目录下的所有文件上传到 `/var/www/html/`

#### 2. 在服务器上配置 Nginx

SSH 登录到服务器：

```bash
ssh root@your-server-ip
```

创建 Nginx 配置文件：

```bash
sudo nano /etc/nginx/sites-available/shuntai-website
```

粘贴以下配置：

```nginx
server {
    listen 80;
    server_name your-domain.com www.your-domain.com;
    # 如果没有域名，使用服务器 IP，或者使用 _ 匹配所有

    root /var/www/html;
    index index.html;

    # 启用 gzip 压缩
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_types text/plain text/css text/xml text/javascript 
               application/x-javascript application/xml+rss 
               application/javascript application/json;

    # SPA 路由支持（重要！）
    location / {
        try_files $uri $uri/ /index.html;
    }

    # 静态资源缓存
    location ~* \.(jpg|jpeg|png|gif|ico|css|js|woff|woff2|ttf|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # 图片资源
    location /images/ {
        expires 7d;
        add_header Cache-Control "public";
    }

    # 字体资源
    location /fonts/ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

保存文件（Ctrl+O, Enter, Ctrl+X）

启用站点：

```bash
# 创建软链接
sudo ln -s /etc/nginx/sites-available/shuntai-website /etc/nginx/sites-enabled/

# 删除默认站点（如果有）
sudo rm /etc/nginx/sites-enabled/default

# 测试配置
sudo nginx -t

# 重启 Nginx
sudo systemctl restart nginx
```

#### 3. 配置域名（可选）

如果有域名：

1. 在域名解析中添加 A 记录：
   - 类型：A
   - 主机记录：@ 或 www
   - 记录值：服务器 IP 地址

2. 等待 DNS 解析生效（通常几分钟到几小时）

#### 4. 配置 HTTPS（推荐）

使用 Let's Encrypt 免费 SSL 证书：

```bash
# 安装 Certbot
sudo apt update
sudo apt install certbot python3-certbot-nginx -y

# 获取证书（替换为你的域名）
sudo certbot --nginx -d your-domain.com -d www.your-domain.com

# 测试自动续期
sudo certbot renew --dry-run
```

### 方案2：使用宝塔面板（更简单，适合新手）

1. **在服务器上安装宝塔面板**

```bash
# CentOS/RedHat
yum install -y wget && wget -O install.sh http://download.bt.cn/install/install_6.0.sh && sh install.sh

# Ubuntu/Debian
wget -O install.sh http://download.bt.cn/install/install-ubuntu_6.0.sh && sudo bash install.sh
```

2. **登录宝塔面板**
   - 访问：`http://your-server-ip:8888`
   - 使用安装时显示的账号密码登录

3. **安装 Nginx**
   - 在面板中选择 "软件商店" → 安装 "Nginx"

4. **添加网站**
   - 点击 "网站" → "添加站点"
   - 填写域名（或使用 IP）
   - 根目录：`/www/wwwroot/shuntai-website`

5. **上传文件**
   - 使用宝塔的文件管理器
   - 将 `dist/` 目录下的所有文件上传到网站根目录

6. **配置 Nginx**
   - 点击网站 → "设置" → "配置文件"
   - 在 `location /` 中添加：
   ```nginx
   location / {
       try_files $uri $uri/ /index.html;
   }
   ```

## 部署验证

部署完成后，访问：
- 有域名：`http://your-domain.com` 或 `https://your-domain.com`
- 无域名：`http://your-server-ip`

检查：
- ✅ 首页是否正常显示
- ✅ 导航是否正常
- ✅ 图片是否加载
- ✅ 页面跳转是否正常
- ✅ 所有交互功能是否正常

## 后续更新流程

```bash
# 1. 本地修改代码后
npm run build

# 2. 提交到 Git
git add .
git commit -m "更新说明"
git push

# 3. 上传到服务器
rsync -avz --delete dist/ root@your-server-ip:/var/www/html/
```

## 注意事项

1. **文件权限**：确保 Nginx 可以读取文件
   ```bash
   sudo chown -R www-data:www-data /var/www/html
   sudo chmod -R 755 /var/www/html
   ```

2. **防火墙**：确保开放 80 和 443 端口
   ```bash
   # Ubuntu/Debian
   sudo ufw allow 80/tcp
   sudo ufw allow 443/tcp
   
   # CentOS
   sudo firewall-cmd --permanent --add-service=http
   sudo firewall-cmd --permanent --add-service=https
   sudo firewall-cmd --reload
   ```

3. **图片资源**：确保 `public/images/` 下的图片都已上传

4. **字体文件**：如果下载了字体，确保 `public/fonts/` 下的字体文件都已上传

## 需要帮助？

如果遇到问题，请检查：
- 服务器日志：`sudo tail -f /var/log/nginx/error.log`
- Nginx 状态：`sudo systemctl status nginx`
- 文件权限是否正确
- 端口是否开放

详细的部署说明请参考 `GITHUB_DEPLOY.md` 文件。
